#!/usr/bin/env python3

from pwn import *

elf = ELF("./open-house_patched")
libc = ELF("./libc6-i386_2.34-0ubuntu1_amd64.so")
ld = ELF("./ld-2.34.so")

# context.terminal = ['/bin/bash', '-c', 'KITTY_ID=$(kitty @ launch --cwd=current); kitty @ send-text -m id:$KITTY_ID exec $0 $@ \\\\n']
context.terminal = ['tmux', 'splitw', '-h']

if args.REMOTE:
	p = remote()
else:
	p = process([ld.path, elf.path], env={"LD_PRELOAD": libc.path})

def exploit():
    p.interactive()

if __name__ == "__main__":
	exploit()
