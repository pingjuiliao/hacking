#!/usr/bin/env python3

from pwn import *

elf = ELF("./tcache_tear_patched")
libc = ELF("./given/libc-18292bd12d37bfaf58e8dded9db7f1f5da1192cb.so")
ld = ELF("./ld-2.27.so")


def conn():
    if args.REMOTE:
        p = remote("chall.pwnable.tw", 10400)
    else:
        p = process([ld.path, elf.path], {"LD_PRELOAD": libc.path})
    return p

def exploit():
    p = conn()

    # good luck pwning :)

    p.interactive()


if __name__ == "__exploit__":
    exploit()
