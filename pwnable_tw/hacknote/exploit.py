#!/usr/bin/env python3

from pwn import *

elf = ELF("./hacknote_patched")
libc = ELF("./given/libc_32.so.6")
ld = ELF("./ld-2.23.so")

def conn():
    if args.REMOTE:
        p = remote("chall.pwnable.tw", 10102)
    else:
        p = process([ld.path, elf.path],
                    env={"LD_PRELOAD": libc.path})
    return p

def exploit():
    p = conn()

    # good luck pwning :)

    r.interactive()


if __name__ == "__main__":
    exploit()
